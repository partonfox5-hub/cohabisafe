<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wait Screen - Cohabisafe</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <header role="banner">
        <h1>Verification in Progress</h1>
        <p class="progress">Step 6 of 6: Awaiting Approval</p>
        <div class="progress-bar" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" aria-label="Verification progress">
            <div class="progress-fill" style="width: 100%;"></div>
        </div>
    </header>

    <main id="main-content" role="main">
        <section aria-label="Processing status">
            <div class="processing-message" role="status">
                <h2>Background Check & Matchmaking Processing</h2>
                <p>Payment processed! Your Elite verification is underway. Expect results in 3-7 business days.</p>
                <p>We'll email you at your registered address when complete.</p>
                <div class="spinner" aria-label="Processing spinner" role="img">
                    <!-- Simple CSS spinner -->
                    <div class="spinner-ring"></div>
                </div>
            </div>

            <div class="teaser">
                <h3>While You Wait</h3>
                <ul>
                    <li>Review your <a href="/profile">CohabiCard Profile</a></li>
                    <li>Update <a href="/quiz">quiz answers</a> if needed</li>
                    <li>Explore <a href="/settings">email preferences</a></li>
                </ul>
            </div>

            <a href="/dashboard" class="btn-primary">Go to Dashboard (Basic Access)</a>
            <button type="button" class="btn-secondary" onclick="checkStatus()">Check Status</button>
        </section>
    </main>

    <footer role="contentinfo">
        <p><a href="/terms">Terms</a> | <a href="/privacy">Privacy</a></p>
    </footer>

    <script>
        // Spinner CSS (inline for simplicity)
        const style = document.createElement('style');
        style.textContent = `
            .spinner { display: flex; justify-content: center; margin: 2rem 0; }
            .spinner-ring { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #007bff; border-radius: 50%; animation: spin 1s linear infinite; }
            @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
            @media (prefers-reduced-motion: reduce) { .spinner-ring { animation: none; } }
        `;
        document.head.appendChild(style);

        // Poll status every 24h (mock)
        function checkStatus() {
            // Simulate fetch to /status
            fetch('/status?userId=1') // Assume userId
                .then(res => res.json())
                .then(data => {
                    if (data.status === 'verified') {
                        alert('Verified! Redirecting to full dashboard.');
                        window.location.href = '/dashboard';
                    } else {
                        alert('Still processing. Check email for updates.');
                    }
                })
                .catch(() => alert('Check later.'));
        }

        // WCAG: Announce load
        window.addEventListener('load', () => {
            const announcement = document.createElement('div');
            announcement.setAttribute('aria-live', 'polite');
            announcement.textContent = 'Verification processing. Please wait for email notification.';
            document.body.insertBefore(announcement, document.body.firstChild);
        });
    </script>
</body>
</html>